{% extends "layout.html" %}
{% block body %}
<h1 class="page-header">Détails de l'Utilisateur</h1>

<div class="container">
    <ul>
        <li>Pseudo: {{ user.nickname }}</li>
        {% if current_user.is_authenticated and current_user.has_permission("admin") %}
            <a href="{{ url_for('user_blueprint.nickname_delete', steam_id=user.id) }}">Supprimer le pseudo du joueur (force nouveau choix)</a>
        {% endif %}
        <li>SteamID: {{ user.id }}</li>
        <li>Utilisateur vérifié: {{ user.verified }}</li>
        {% if current_user.is_authenticated and current_user.has_permission("admin") %}
            <a href="{{ url_for('user_blueprint.verify_user', steam_id=user.id) }}">Verifier/Dévérifier utilisateur</a>
        {% endif %}
        <li><img src="{{ user.avatar }}"><img src="{{ user.avatar_medium }}"><img src="{{ user.avatar_full }}"></li>
        <li><a href="http://www.dotabuff.com/players/{{ user.id }}">Dotabuff</a> & <a href="http://steamcommunity.com/profiles/{{ user.id }}">Steam Profile</a></li>

        <li>Admin:
            {% if user.has_permission("admin") %}
            Oui
            {% else %}
            Non
            {% endif %}
        </li>
        {% if current_user.is_authenticated and current_user.has_permission("admin") %}
            {% if user.has_permission("admin") %}
            <a href="{{ url_for('user_blueprint.user_permission', steam_id=user.id, permission='admin', give=False) }}">Retirer droits d'administration</a>
            {% else %}
            <a href="{{ url_for('user_blueprint.user_permission', steam_id=user.id, permission='admin', give=True) }}">Donner droits d'administration</a>
            {% endif %}
        {% endif %}

        <li>Joueur VIP:
            {% if user.has_permission("play_vip") %}
            Oui
            {% else %}
            Non
            {% endif %}
        </li>
        {% if current_user.is_authenticated and current_user.has_permission("admin") %}
            {% if user.has_permission("play_vip") %}
            <a href="{{ url_for('user_blueprint.user_permission', steam_id=user.id, permission='play_vip', give=False) }}">Retirer la permission de jouer</a>
            {% else %}
            <a href="{{ url_for('user_blueprint.user_permission', steam_id=user.id, permission='play_vip', give=True) }}">Donner la permission de jouer</a>
            {% endif %}
        {% endif %}

        <li>Dernier scan:
            {% if user.profile_scan_info is not none and user.profile_scan_info.last_scan is not none %}
            {{ user.profile_scan_info.last_scan}}
            {% else %}
            Jamais
            {% endif %}
        </li>
        <li>Dernier Solo MMR scanné :
            {% if user.solo_mmr is none %}
            Inconnu
            {% else %}
            {{ user.solo_mmr }}
            {% endif %}
        </li>
    </ul>

    {% if current_user.is_authenticated and current_user.id == user.id %}
    <p>
        {% if scan_possible %}
            <a href="{{ url_for('user_blueprint.user_scan') }}">Cliquez-ici</a> pour lancer un nouveau scan.
        {% else %}
        Un scan est en cours, rafraichissez la page dans un moment. Vous ne pouvez lancer un scan qu'une fois toutes les 5 minutes.
        {% endif %}
    </p>
    {% endif %}

</div>
{% endblock %}
